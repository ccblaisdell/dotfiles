# /Users/ccblaisdell/.config/tmuxinator/spiff_staging.yml

name: spiff_staging
root: ~/

# Specifies (by name or index) which window will be selected on project startup. If not set, the first window is used.
startup_window: main

windows:
  - services:
      layout: tiled
      panes:
        - db:
          - source ~/.spiff/.env.proxy
          - pg_ctl start
          - ~/dev/cloud_sql_proxy -dir=$DB_DIR -instances $DB_INSTANCE
        - sidekiq:
          - source ~/.spiff/.env.proxy
          - cd ~/dev/spiff_rb
          - bundle exec sidekiq
        - redis:
          - source ~/.spiff/.env.proxy
          - cd ~/dev spiff_ex
          - redis-server
        - nats:
          - source ~/.spiff/.env.proxy
          - nats-server --trace
  - apps:
      layout: tiled
      panes:
        - spiff_rb:
          - cd ~/dev/spiff_rb
          - source ~/.spiff/.env.proxy
          - bundle exec rails server -p 3001
        - spiff_react:
          - cd ~/dev/spiff_react
          - npx wait-on http://localhost:3001 && yarn dev --env errorOverlay
        - spiff_ex:
          - cd ~/dev/spiff_ex
          - source ~/.spiff/.env.proxy
          - iex -S mix phx.server
        - mcfeely:
          - cd ~/dev/mcfeely
          - iex -S mix phx.server
        - peg:
          - cd ~/dev/peg
          - source ~/.spiff/.env.proxy
          - COMPANY_IDS=1219 iex -S mix phx.server
        - biff:
          - cd ~/dev/biff
          - mix clean && iex -S mix phx.server
  - main:
      root: ~/dev/spiff_react
      layout: main-vertical
      panes:
        - clear

